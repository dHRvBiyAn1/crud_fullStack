<div class="container">
  <div class="header">
    <h1>Student Management</h1>
    <button class="btn btn-primary" (click)="addStudent()">+ Add Student</button>
  </div>

  <!-- Error Message -->
  <div class="error" *ngIf="errorMessage">
    {{ errorMessage }}
  </div>

  <!-- Search Bar (Real-time, No Button) -->
  <div class="search-section">
    <input 
      type="text" 
      placeholder="Search by name, email, or username..." 
      [(ngModel)]="searchTerm"
      (ngModelChange)="onSearchChange()"
      class="search-input"
    />
    <span class="search-info" *ngIf="searchTerm">
      Found {{ getTotalDisplayed() }} result{{ getTotalDisplayed() !== 1 ? 's' : '' }}
    </span>
  </div>

  <!-- Table -->
  <div class="table-container" *ngIf="displayedStudents.length > 0">
    <table>
      <thead>
        <tr>
          <th>S.No</th>
          <th (click)="onHeaderClick('firstName')" class="sortable">
            First Name{{ getSortIndicator('firstName') }}
          </th>
          <th (click)="onHeaderClick('lastName')" class="sortable">
            Last Name{{ getSortIndicator('lastName') }}
          </th>
          <th (click)="onHeaderClick('email')" class="sortable">
            Email{{ getSortIndicator('email') }}
          </th>
          <th (click)="onHeaderClick('username')" class="sortable">
            Username{{ getSortIndicator('username') }}
          </th>
          <th (click)="onHeaderClick('createdAt')" class="sortable">
            Created At{{ getSortIndicator('createdAt') }}
          </th>
          <th (click)="onHeaderClick('updatedAt')" class="sortable">
            Updated At{{ getSortIndicator('updatedAt') }}
          </th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let student of displayedStudents; let i = index">
          <td>{{ getStartIndex() + i }}</td>
          <td>{{ student.firstName }}</td>
          <td>{{ student.lastName }}</td>
          <td>{{ student.email }}</td>
          <td>{{ student.username }}</td>
          <td>{{ student.createdAt | date: 'short' }}</td>
          <td>{{ student.updatedAt | date: 'short' }}</td>
          <td class="actions">
            <button class="btn btn-edit" (click)="editStudent(student.id)">Edit</button>
            <button class="btn btn-delete" (click)="deleteStudent(student.id)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Empty State (No Students) -->
  <div class="empty-state" *ngIf="allStudents.length === 0 && !errorMessage">
    <p>No students found. Add your first student!</p>
  </div>

  <!-- Empty State (No Search Results) -->
  <div class="empty-state" *ngIf="allStudents.length > 0 && displayedStudents.length === 0 && searchTerm">
    <p>No students found matching "{{ searchTerm }}"</p>
  </div>

  <!-- Pagination -->
  <div class="pagination-simple" *ngIf="totalPages > 1 && displayedStudents.length > 0">
    <div class="pagination-info">
      Showing {{ getStartIndex() }} to {{ getEndIndex() }} of {{ getTotalDisplayed() }} students
      (Page {{ currentPage + 1 }} of {{ totalPages }})
    </div>
    <div class="pagination-buttons">
      <button 
        class="btn btn-nav" 
        (click)="goToPreviousPage()" 
        [disabled]="isFirstPage"
      >
        ← Previous
      </button>
      <button 
        class="btn btn-nav" 
        (click)="goToNextPage()" 
        [disabled]="isLastPage"
      >
        Next →
      </button>
    </div>
  </div>
</div>
